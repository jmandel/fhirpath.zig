{
  "meta": {
    "status": "implemented",
    "feature": "existence",
    "source": "spec/index.md#Existence"
  },
  "spec": {
    "summary": [
      "empty() returns true when the input collection has no items; otherwise false.",
      "exists() returns true when the input collection has any items; otherwise false.",
      "exists() is the opposite of empty() and is shorthand for empty().not().",
      "exists(criteria) is shorthand for where(criteria).exists()."
    ],
    "examples": [
      "Patient.name.empty()",
      "Patient.name.exists()"
    ]
  },
  "todo": [
    "[x] Implement empty() on collections (true for {}, false otherwise).",
    "[x] Implement exists() on collections (true for non-empty, false for {}).",
    "[ ] Implement exists(criteria) as where(criteria).exists().",
    "[ ] Add criteria-based tests once where() is supported.",
    "[x] Improve passing rate (8/8 passing)."
  ],
  "cases": [
    {
      "name": "empty on missing field returns true",
      "expr": "name.empty()",
      "input": {},
      "expect": [
        {
          "type": "boolean",
          "value": true
        }
      ]
    },
    {
      "name": "empty on empty array returns true",
      "expr": "name.empty()",
      "input": {
        "name": []
      },
      "expect": [
        {
          "type": "boolean",
          "value": true
        }
      ]
    },
    {
      "name": "empty on non-empty array returns false",
      "expr": "name.empty()",
      "input": {
        "name": [
          "Ann"
        ]
      },
      "expect": [
        {
          "type": "boolean",
          "value": false
        }
      ]
    },
    {
      "name": "exists on missing field returns false",
      "expr": "name.exists()",
      "input": {},
      "expect": [
        {
          "type": "boolean",
          "value": false
        }
      ]
    },
    {
      "name": "exists on empty array returns false",
      "expr": "name.exists()",
      "input": {
        "name": []
      },
      "expect": [
        {
          "type": "boolean",
          "value": false
        }
      ]
    },
    {
      "name": "exists on non-empty array returns true",
      "expr": "name.exists()",
      "input": {
        "name": [
          "Ann",
          "Bob"
        ]
      },
      "expect": [
        {
          "type": "boolean",
          "value": true
        }
      ]
    },
    {
      "name": "empty on scalar value returns false",
      "expr": "active.empty()",
      "input": {
        "active": true
      },
      "expect": [
        {
          "type": "boolean",
          "value": false
        }
      ]
    },
    {
      "name": "exists on scalar value returns true",
      "expr": "active.exists()",
      "input": {
        "active": true
      },
      "expect": [
        {
          "type": "boolean",
          "value": true
        }
      ]
    }
  ]
}
