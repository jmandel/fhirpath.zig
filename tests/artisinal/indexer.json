{
  "meta": {
    "status": "implemented",
    "feature": "indexer",
    "source": "spec/index.md#Subsetting"
  },
  "spec": {
    "summary": [
      "The indexer returns a collection containing only the item at the given 0-based index.",
      "If the input collection is empty or the index is out of bounds, the result is empty.",
      "Unless a model specifies otherwise, collections are 0-based; even if a model is 1-based, derived collections are 0-based."
    ],
    "examples": [
      "Patient.name[0]"
    ]
  },
  "todo": [
    "[x] Implement parsing of indexer expressions (e.g., path[0]).",
    "[x] Implement indexer evaluation with 0-based bounds checking.",
    "[ ] Add string indexing tests once string semantics are supported.",
    "[x] Improve passing rate (5/5 passing)."
  ],
  "cases": [
    {
      "name": "indexer selects first item",
      "expr": "name[0]",
      "input": { "name": ["Ann", "Bob"] },
      "expect": ["Ann"]
    },
    {
      "name": "indexer selects second item",
      "expr": "name[1]",
      "input": { "name": ["Ann", "Bob"] },
      "expect": ["Bob"]
    },
    {
      "name": "indexer out of range returns empty",
      "expr": "name[2]",
      "input": { "name": ["Ann", "Bob"] },
      "expect": []
    },
    {
      "name": "indexer on empty collection returns empty",
      "expr": "name[0]",
      "input": { "name": [] },
      "expect": []
    },
    {
      "name": "indexer after path over nested arrays",
      "expr": "name.given[0]",
      "input": {
        "name": [
          { "given": ["Ann", "Annie"] },
          { "given": ["Bob"] }
        ]
      },
      "expect": ["Ann"]
    }
  ]
}
