{
  "meta": {
    "status": "implemented",
    "spec_summary": "substring(start [, length]) extracts part of string. Start is 0-based. If start is outside string bounds, returns empty {}. If length exceeds remaining chars, returns remaining. Empty/zero/negative length returns empty string ''. Empty input/start returns empty {}."
  },
  "todo": [
    "All 21 tests passing"
  ],
  "cases": [
    {
      "name": "substring - basic no length",
      "expr": "'abcdefg'.substring(3)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "defg"
        }
      ]
    },
    {
      "name": "substring - from start",
      "expr": "'abcdefg'.substring(0)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "abcdefg"
        }
      ]
    },
    {
      "name": "substring - from last char",
      "expr": "'abcdefg'.substring(6)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "g"
        }
      ]
    },
    {
      "name": "substring - start equals length (empty result)",
      "expr": "'abcdefg'.substring(7)",
      "input": {},
      "expect": [],
      "note": "start position is outside the string, returns empty collection"
    },
    {
      "name": "substring - start beyond length",
      "expr": "'12345'.substring(25)",
      "input": {},
      "expect": []
    },
    {
      "name": "substring - negative start",
      "expr": "'12345'.substring(-1)",
      "input": {},
      "expect": [],
      "note": "negative start is outside string, returns empty collection"
    },
    {
      "name": "substring - with length",
      "expr": "'abcdefg'.substring(1, 2)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "bc"
        }
      ]
    },
    {
      "name": "substring - length exceeds remaining",
      "expr": "'abcdefg'.substring(6, 2)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "g"
        }
      ],
      "note": "only one char remaining, returns that"
    },
    {
      "name": "substring - length exceeds remaining from middle",
      "expr": "'12345'.substring(2, 5)",
      "input": {},
      "expect": [
        {
          "type": "integer",
          "value": 345
        }
      ]
    },
    {
      "name": "substring - zero length returns empty string",
      "expr": "'abcdefg'.substring(3, 0)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": ""
        }
      ]
    },
    {
      "name": "substring - negative length returns empty string",
      "expr": "'abcdefg'.substring(3, -1)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": ""
        }
      ]
    },
    {
      "name": "substring - negative start with negative length",
      "expr": "'abcdefg'.substring(-1, -1)",
      "input": {},
      "expect": [],
      "note": "start outside string takes precedence, returns empty collection not empty string"
    },
    {
      "name": "substring - empty input yields empty",
      "expr": "{}.substring(0)",
      "input": {},
      "expect": []
    },
    {
      "name": "substring - empty start yields empty",
      "expr": "'string'.substring({})",
      "input": {},
      "expect": []
    },
    {
      "name": "substring - empty input and empty start",
      "expr": "{}.substring({})",
      "input": {},
      "expect": []
    },
    {
      "name": "substring - empty length treated as omitted",
      "expr": "'abcdefg'.substring(3, {})",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "defg"
        }
      ],
      "note": "empty length behaves as if length not provided"
    },
    {
      "name": "substring - length of 1",
      "expr": "'abcdefg'.substring(0, 1)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "a"
        }
      ]
    },
    {
      "name": "substring - entire string with exact length",
      "expr": "'abcdefg'.substring(0, 7)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": "abcdefg"
        }
      ]
    },
    {
      "name": "substring - numeric string",
      "expr": "'12345'.substring(2, 1)",
      "input": {},
      "expect": [
        {
          "type": "integer",
          "value": 3
        }
      ]
    },
    {
      "name": "substring - empty string from start 0",
      "expr": "''.substring(0)",
      "input": {},
      "expect": [
        {
          "type": "string",
          "value": ""
        }
      ]
    },
    {
      "name": "substring - empty string from start 1",
      "expr": "''.substring(1)",
      "input": {},
      "expect": [],
      "note": "start 1 is outside empty string"
    }
  ]
}
