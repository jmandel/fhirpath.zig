<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FHIRPath Zig — WASM Demo</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet" />
</head>
<body>
  <div class="background">
    <div class="orb orb-a"></div>
    <div class="orb orb-b"></div>
    <div class="grid"></div>
  </div>

  <main class="page">
    <header class="hero">
      <div>
        <p class="eyebrow">FHIRPath · Zig · WebAssembly</p>
        <h1>Evaluate FHIRPath in the browser with native speed.</h1>
        <p class="subhead">
          A greenfield Zig engine compiled to WASM, with schema-aware typing
          and native FHIR JSON + XML support.
        </p>
        <pre class="code-inline"><code><span class="hl-kw">import</span> {FhirPathEngine} <span class="hl-kw">from</span> <span class="hl-str">"https://joshuamandel.com/fhirpath.zig/fhirpath.js"</span>;
<span class="hl-kw">const</span> engine = <span class="hl-kw">await</span> FhirPathEngine.<span class="hl-fn">instantiate</span>({schemas: [{name: <span class="hl-str">"r5"</span>, isDefault: <span class="hl-lit">true</span>}]});
engine.<span class="hl-fn">eval</span>({expr: <span class="hl-str">"name.given"</span>, json: patientJson, schema: <span class="hl-str">"r5"</span>});</code></pre>
        <div class="hero-links">
          <a href="./tests.json">Test suite</a>
          <span class="hero-links-sep">·</span>
          <a href="https://dev.fhirpath-lab.com/FhirPath-engines?engines=https%3A%2F%2Fjoshuamandel.com%2Ffhirpath.zig%2Flabreport-r5.json">Lab report</a>
        </div>
      </div>
    </header>

    <div class="toolbar">
      <select id="schema-select" class="schema-select">
        <option value="r5" selected>FHIR R5</option>
        <option value="r4">FHIR R4</option>
      </select>
      <div class="format-toggle" id="format-toggle">
        <button class="toggle-btn active" data-format="json-string">JSON string</button>
        <button class="toggle-btn" data-format="json-adapter">JSON adapter</button>
        <button class="toggle-btn" data-format="xml">XML string</button>
      </div>
      <div class="chips" id="chip-row"></div>
    </div>

    <section class="panel-grid">
      <div class="panel">
        <div class="panel-header">
          <h2>Expression</h2>
        </div>
        <textarea id="expr" class="expr-input" spellcheck="false"></textarea>
      </div>

      <div class="panel">
        <div class="panel-header">
          <h2 id="input-label">Input JSON</h2>
          <span class="meta" id="input-meta"></span>
        </div>
        <textarea id="json" class="json-input" spellcheck="false"></textarea>
      </div>

      <div class="panel results">
        <div class="panel-header">
          <h2>Results</h2>
          <span class="meta" id="status">Loading WASM…</span>
        </div>
        <div class="results-body" id="results"></div>
      </div>
    </section>

    <footer class="mobile-footer">
      <pre class="code-inline"><code><span class="hl-kw">import</span> {FhirPathEngine} <span class="hl-kw">from</span> <span class="hl-str">"https://joshuamandel.com/fhirpath.zig/fhirpath.js"</span>;
<span class="hl-kw">const</span> engine = <span class="hl-kw">await</span> FhirPathEngine.<span class="hl-fn">instantiate</span>({schemas: [{name: <span class="hl-str">"r5"</span>, isDefault: <span class="hl-lit">true</span>}]});
engine.<span class="hl-fn">eval</span>({expr: <span class="hl-str">"name.given"</span>, json: patientJson, schema: <span class="hl-str">"r5"</span>});</code></pre>
      <div class="hero-links">
        <a href="./tests.json">Test suite</a>
        <span class="hero-links-sep">·</span>
        <a href="https://dev.fhirpath-lab.com/FhirPath-engines?engines=https%3A%2F%2Fjoshuamandel.com%2Ffhirpath.zig%2Flabreport-r5.json">Lab report</a>
      </div>
    </footer>
  </main>

  <script type="module" src="./app.js"></script>
</body>
</html>
