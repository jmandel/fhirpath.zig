# Upstream Issues (YAML)
#
# Track issues to report to FHIRPath specification/reference implementation maintainers.
# Format is simple YAML for deterministic parsing by scripts.
# Only single-line values are supported.
#
# Allowed status values: draft, ready, reported, acknowledged, fixed, wontfix, duplicate
# Allowed severity values: low, medium, high, critical
# Allowed category values: spec-ambiguity, spec-error, test-error, test-missing, clarification
# Allowed target values: fhirpath-editors, fhir-test-cases, fhir-jira
#
# Workflow:
#   1. Add issue with status=draft while investigating
#   2. Change to status=ready when ready to file upstream
#   3. Run `upstream.py report <slug>` to generate report, then update to status=reported
#   4. Update to acknowledged/fixed/wontfix/duplicate based on upstream response

version: 1
issues:
  - slug: is-as-precedence-conflicts-between-spec-table-and-official-tests
    status: draft
    severity: medium
    category: spec-ambiguity
    target: fhirpath-editors
    title: is/as precedence conflicts between spec table and official tests
    description: "The spec precedence table (ยง6.1) says is/as (#6) binds tighter than comparison (#8). But testPrecedence3 expects '1 > 2 is Boolean' to parse as (1>2) is Boolean = true, implying comparison binds tighter. fhirpath.js follows the spec table and errors. Clarification needed."
    spec_section: 6.1 Operator Precedence
    created: 2026-01-28
    updated: 2026-01-28
  - slug: lowboundary-highboundary-tests-expect-datetime-for-date-input
    status: draft
    severity: medium
    category: test-error
    target: fhirpath-editors
    title: lowBoundary/highBoundary tests expect dateTime for Date input
    description: "Spec says lowBoundary 'returns the same type as the value in the input collection'. For @2014 (a Date literal), the tests expect type 'dateTime' but should expect 'date'. Affected tests: LowBoundaryDateMonth, HighBoundaryDateMonth, HighBoundaryDateTimeMillisecond1, HighBoundaryDateTimeMillisecond3."
    expected: dateTime
    actual: date
    test_file: tests-fhir-r5.xml
    test_name: LowBoundaryDateMonth
    created: 2026-01-28
    updated: 2026-01-28
  - slug: r5-tests-testsort8-testsort10-use-invalid-this-on-strings
    status: draft
    severity: medium
    category: test-error
    target: fhirpath-editors
    title: R5 tests testSort8/testSort10 use invalid -$this on strings
    description: "Tests testSort8 and testSort10 use -$this to reverse sort order, but -$this (unary minus) is not valid for strings. The spec shows 'desc' keyword for descending: ('c'|'a'|'b').sort($this desc). Firely .NET errors on -string. Suggest changing to use 'desc' keyword."
    expected: sort('-$this') on strings should reverse sort order
    actual: Unary minus on strings is not valid - should error or use 'desc' keyword
    test_file: tests-fhir-r5.xml
    test_name: testSort8, testSort10
    created: 2026-01-28
    updated: 2026-01-28
